<!DOCTYPE html><html><head><meta charset="utf-8"><title>readme.md</title><style></style></head><body id="preview">
<h1 class="code-line" data-line-start=0 data-line-end=1><a id="PSA_Crypto_ECDSA_0"></a>PSA Crypto ECDSA</h1>
<p class="has-line-data" data-line-start="2" data-line-end="3">This example uses the PSA Crypto API to perform ECDSA digital signature on the supported device.</p>
<p class="has-line-data" data-line-start="4" data-line-end="5">In this example, the PSA Crypto API is used to generate a private-public key pair using a given Elliptic Curve Cryptography (ECC) curve. The private key is first used to sign the hash of a message buffer. The signature is then verified using the public key.</p>
<p class="has-line-data" data-line-start="6" data-line-end="7">The build-in asymmetric keys can be selected for ECDSA operations if these keys are available on the supported device. The private sign key and private command keys are stored in device memory to sign the hash. The device’s public sign key and public command key in the SE OTP must match with the public keys of the private sign key and private command key to verify the signature.</p>
<p class="has-line-data" data-line-start="8" data-line-end="9">The default private sign key (<code>rootsign-unsafe-privkey.pem</code>) and private command key (<code>cmd-unsafe-privkey.pem</code>) can be found in the Windows folder below.</p>
<p class="has-line-data" data-line-start="10" data-line-end="11"><em>C:\SiliconLabs\SimplicityStudio\v5\developer\adapter_packs\secmgr\scripts\offline</em></p>
<p class="has-line-data" data-line-start="12" data-line-end="13">The public key of <code>rootsign-unsafe-privkey.pem</code> is:</p>
<p class="has-line-data" data-line-start="14" data-line-end="15"><code>X - C4AF4AC69AAB9512DB50F7A26AE5B4801183D85417E729A56DA974F4E08A562C</code></p>
<p class="has-line-data" data-line-start="16" data-line-end="17"><code>Y - DE6019DEA9411332DC1A743372D170B436238A34597C410EA177024DE20FC819</code></p>
<p class="has-line-data" data-line-start="18" data-line-end="19">The public key of <code>cmd-unsafe-privkey.pem</code> is:</p>
<p class="has-line-data" data-line-start="20" data-line-end="21"><code>X - B1BC6F6FA56640ED522B2EE0F5B3CF7E5D48F60BE8148F0DC08440F0A4E1DCA4</code></p>
<p class="has-line-data" data-line-start="22" data-line-end="23"><code>Y - 7C04119ED6A1BE31B7707E5F9D001A659A051003E95E1B936F05C37EA793AD63</code></p>
<p class="has-line-data" data-line-start="24" data-line-end="25">If the public sign key or public command key has not been provisioned on the device, the program will skip the signature verification of this public key.</p>
<p class="has-line-data" data-line-start="26" data-line-end="27">The example redirects standard I/O to the virtual serial port (VCOM) of the kit. By default, the serial port setting is 115200 bps and 8-N-1 configuration.</p>
<p class="has-line-data" data-line-start="28" data-line-end="29">Except for the Series 1 Cortex-M0+ device, the example has been instrumented with code to count the number of clock cycles spent in different operations. The results are printed on the VCOM serial port console. This feature can be disabled by defining <code>PSA_CRYPTO_PRINT=0</code> (default is 1) in the IDE setting (<code>Preprocessor-&gt;Defined symbols</code>).</p>
<h2 class="code-line" data-line-start=30 data-line-end=31><a id="Key_Storage_30"></a>Key Storage</h2>
<p class="has-line-data" data-line-start="32" data-line-end="33">The following key storages are supported in this example:</p>
<ul>
<li class="has-line-data" data-line-start="34" data-line-end="35">Volatile plain key in RAM</li>
<li class="has-line-data" data-line-start="35" data-line-end="36">Persistent plain key in <a href="https://docs.silabs.com/gecko-platform/3.1/driver/api/group-nvm3">NVM3</a></li>
<li class="has-line-data" data-line-start="36" data-line-end="37">Volatile wrapped key in RAM (Secure Vault device only)</li>
<li class="has-line-data" data-line-start="37" data-line-end="39">Persistent wrapped key in NVM3 (Secure Vault device only)</li>
</ul>
<h2 class="code-line" data-line-start=39 data-line-end=40><a id="Elliptic_Curve_Key_39"></a>Elliptic Curve Key</h2>
<p class="has-line-data" data-line-start="41" data-line-end="42">The following elliptic curve keys are supported in this example:</p>
<h5 class="code-line" data-line-start=43 data-line-end=44><a id="PSA_ECC_FAMILY_SECP_R1__43"></a><code>PSA_ECC_FAMILY_SECP_R1</code> :</h5>
<ul>
<li class="has-line-data" data-line-start="45" data-line-end="46">SECP192R1 - 192-bit</li>
<li class="has-line-data" data-line-start="46" data-line-end="47">SECP256R1 - 256-bit</li>
<li class="has-line-data" data-line-start="47" data-line-end="48">SECP384R1 - 384-bit</li>
<li class="has-line-data" data-line-start="48" data-line-end="50">SECP521R1 - 521-bit</li>
</ul>
<h2 class="code-line" data-line-start=50 data-line-end=51><a id="Asymmetric_Signature_Algorithm_50"></a>Asymmetric Signature Algorithm</h2>
<p class="has-line-data" data-line-start="52" data-line-end="53">The following asymmetric signature algorithms are supported in this example:</p>
<ul>
<li class="has-line-data" data-line-start="54" data-line-end="55"><code>PSA_ALG_ECDSA(hash_alg)</code></li>
<li class="has-line-data" data-line-start="55" data-line-end="57"><code>PSA_ALG_ECDSA_ANY</code></li>
</ul>
<h2 class="code-line" data-line-start=57 data-line-end=58><a id="Hash_Algorithm_57"></a>Hash Algorithm</h2>
<p class="has-line-data" data-line-start="59" data-line-end="60">The following hash algorithms are supported in this example:</p>
<ul>
<li class="has-line-data" data-line-start="61" data-line-end="62"><code>PSA_ALG_SHA_1</code></li>
<li class="has-line-data" data-line-start="62" data-line-end="63"><code>PSA_ALG_SHA_224</code></li>
<li class="has-line-data" data-line-start="63" data-line-end="64"><code>PSA_ALG_SHA_256</code></li>
<li class="has-line-data" data-line-start="64" data-line-end="65"><code>PSA_ALG_SHA_384</code></li>
<li class="has-line-data" data-line-start="65" data-line-end="67"><code>PSA_ALG_SHA_512</code></li>
</ul>
<h2 class="code-line" data-line-start=67 data-line-end=68><a id="Builtin_Key_67"></a>Built-in Key</h2>
<p class="has-line-data" data-line-start="69" data-line-end="70">The following built-in keys are supported in this example:</p>
<ul>
<li class="has-line-data" data-line-start="71" data-line-end="72">Public sign key in the SE OTP (HSE only)</li>
<li class="has-line-data" data-line-start="72" data-line-end="73">Public command key in the SE OTP (HSE only)</li>
<li class="has-line-data" data-line-start="73" data-line-end="75">Private device key in the secure key storage (Secure Vault device only)</li>
</ul>
<h2 class="code-line" data-line-start=75 data-line-end=76><a id="PSA_Crypto_API_75"></a>PSA Crypto API</h2>
<p class="has-line-data" data-line-start="77" data-line-end="78">The following PSA Crypto APIs are used in this example:</p>
<ul>
<li class="has-line-data" data-line-start="79" data-line-end="80"><code>psa_crypto_init</code></li>
<li class="has-line-data" data-line-start="80" data-line-end="81"><code>psa_key_attributes_init</code></li>
<li class="has-line-data" data-line-start="81" data-line-end="82"><code>psa_set_key_type</code></li>
<li class="has-line-data" data-line-start="82" data-line-end="83"><code>psa_set_key_bits</code></li>
<li class="has-line-data" data-line-start="83" data-line-end="84"><code>psa_set_key_usage_flags</code></li>
<li class="has-line-data" data-line-start="84" data-line-end="85"><code>psa_set_key_algorithm</code></li>
<li class="has-line-data" data-line-start="85" data-line-end="86"><code>psa_set_key_id</code></li>
<li class="has-line-data" data-line-start="86" data-line-end="87"><code>psa_set_key_lifetime</code></li>
<li class="has-line-data" data-line-start="87" data-line-end="88"><code>psa_generate_key</code></li>
<li class="has-line-data" data-line-start="88" data-line-end="89"><code>psa_import_key</code></li>
<li class="has-line-data" data-line-start="89" data-line-end="90"><code>psa_reset_key_attributes</code></li>
<li class="has-line-data" data-line-start="90" data-line-end="91"><code>psa_export_public_key</code></li>
<li class="has-line-data" data-line-start="91" data-line-end="92"><code>psa_sign_hash</code></li>
<li class="has-line-data" data-line-start="92" data-line-end="93"><code>psa_verify_hash</code></li>
<li class="has-line-data" data-line-start="93" data-line-end="94"><code>psa_open_key</code></li>
<li class="has-line-data" data-line-start="94" data-line-end="95"><code>psa_close_key</code></li>
<li class="has-line-data" data-line-start="95" data-line-end="96"><code>psa_destroy_key</code></li>
<li class="has-line-data" data-line-start="96" data-line-end="98"><code>mbedtls_psa_crypto_free</code></li>
</ul>
<h2 class="code-line" data-line-start=98 data-line-end=99><a id="Getting_Started_98"></a>Getting Started</h2>
<ol>
<li class="has-line-data" data-line-start="100" data-line-end="101">Upgrade the kit’s firmware to the latest version (see <code>Adapter Firmware</code> under <a href="https://docs.silabs.com/simplicity-studio-5-users-guide/latest/ss-5-users-guide-about-the-launcher/welcome-and-device-tabs#general-device-information">General Device Information</a> in Simplicity Studio 5 Users Guide).</li>
<li class="has-line-data" data-line-start="101" data-line-end="102">Upgrade the device’s SE firmware to the latest version when Series 2 device is used (see <code>Secure Firmware</code> under <a href="https://docs.silabs.com/simplicity-studio-5-users-guide/latest/ss-5-users-guide-about-the-launcher/welcome-and-device-tabs#general-device-information">General Device Information</a> in Simplicity Studio 5 Users Guide).</li>
<li class="has-line-data" data-line-start="102" data-line-end="103">Open any terminal program and connect to the kit’s VCOM port (if using <code>Device Console</code> in Simplicity Studio 5, <code>Line terminator:</code> must be set to <code>None</code>).</li>
<li class="has-line-data" data-line-start="103" data-line-end="104">Create this platform example project in the Simplicity IDE (see <a href="https://docs.silabs.com/simplicity-studio-5-users-guide/latest/ss-5-users-guide-getting-started/start-a-project#examples">Examples</a> in Simplicity Studio 5 Users Guide, check <code>Platform()</code> checkbox to browse the platform examples).</li>
<li class="has-line-data" data-line-start="104" data-line-end="105">Build the example and download it to the kit (see <a href="https://docs.silabs.com/simplicity-studio-5-users-guide/latest/ss-5-users-guide-building-and-flashing/building#simple-build">Simple Build</a> and <a href="https://docs.silabs.com/simplicity-studio-5-users-guide/latest/ss-5-users-guide-building-and-flashing/flashing#flash-programmer">Flash Programmer</a> in Simplicity Studio 5 Users Guide).</li>
<li class="has-line-data" data-line-start="105" data-line-end="107">Run the example and follow the instructions shown on the console.</li>
</ol>
<h2 class="code-line" data-line-start=107 data-line-end=108><a id="Additional_Information_107"></a>Additional Information</h2>
<ol>
<li class="has-line-data" data-line-start="109" data-line-end="110">The example uses the CTR-DRBG, a pseudo-random number generator (PRNG) included in <a href="https://docs.silabs.com/mbed-tls/latest/">Mbed TLS</a> to generate the random number. If the example is running on a device including a TRNG (True Random Number Generator) hardware module, the TRNG will be used as an entropy source to seed the CTR-DRBG. If the device does not incorporate a TRNG, the example will use <a href="https://docs.silabs.com/rail/latest/">RAIL</a> or ADC as the entropy source.</li>
<li class="has-line-data" data-line-start="110" data-line-end="111">If an algorithm is not supported in the hardware accelerator of the selected device, the PSA Crypto will use the software fallback feature (if enable) in Mbed TLS.</li>
<li class="has-line-data" data-line-start="111" data-line-end="112">The heap size (<code>4096</code>) in <code>sl_memory_config.h</code> can be reset to the default value (<code>2048</code>) if the software fallback feature in Mbed TLS is disabled.</li>
<li class="has-line-data" data-line-start="112" data-line-end="113">Change the <code>PERSISTENT_KEY_ID</code> value in <code>app_process.h</code> if this key ID had already existed in NVM3.</li>
<li class="has-line-data" data-line-start="113" data-line-end="114">The hash-and-sign functions (<code>psa_sign_message</code> and <code>psa_verify_message</code>) are not supported yet.</li>
<li class="has-line-data" data-line-start="114" data-line-end="116">The default optimization level is <code>Optimize for debugging (-Og)</code> on Simplicity IDE and <code>None</code> on IAR Embedded Workbench.</li>
</ol>
<h2 class="code-line" data-line-start=116 data-line-end=117><a id="Resources_116"></a>Resources</h2>
<p class="has-line-data" data-line-start="118" data-line-end="119"><a href="https://www.silabs.com/documents/public/application-notes/an1222-efr32xg2x-production-programming.pdf">AN1222: Production Programming of Series 2 Devices</a></p>
<p class="has-line-data" data-line-start="120" data-line-end="121"><a href="https://www.silabs.com/documents/public/application-notes/an1268-efr32-secure-identity.pdf">AN1268: Authenticating Silicon Labs Devices Using Device Certificates</a></p>
<p class="has-line-data" data-line-start="122" data-line-end="123"><a href="https://www.silabs.com/documents/public/application-notes/an1311-mbedtls-psa-crypto-porting-guide.pdf">AN1311: Mbed TLS to PSA Crypto Porting Guide</a></p>
</body></html>